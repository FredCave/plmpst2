var Page={winH:$(window).height(),winW:$(window).width(),init:function(){console.log("Page.init"),Info.init(),this.bindEvents(),this.portraitsInit(),this.videoSize()},bindEvents:function(){console.log("Page.bindEvents");var a=this;$(".portrait_wrapper").on("click",function(){a.openVideo($(this).attr("data-link"))}),$("#back_button a").on("click",function(b){b.preventDefault(),a.closeVideo(a.currentPlayer)}),$(window).on("resize",_.throttle(function(){a.winH=$(window).height(),a.winW=$(window).width(),a.videoSize()},250))},portraitsInit:function(){console.log("Page.portraitsInit");var a=this,b=0;$(".portrait_wrapper").each(function(){var c=$(this).find("video").get(0);if(a.winW>768){var d=$(c).find("source").attr("src"),e=d.replace("_small","_large");$(c).find("source").attr("src",e)}c.oncanplay=function(){$(c).parent().fadeIn(1e3),b++,3===b&&a.vimeoVideosInit()}})},vimeoVideosInit:function(){console.log("Page.vimeoVideosInit"),Info.detectMobile()?(console.log(84,"Mobile detected"),$("iframe").each(function(){var a=$(this).attr("data-src").replace("background=1","");console.log(87,a),$(this).attr("src",a)})):console.log(91,"Mobile not detected")},videoSize:function(){console.log("Page.videoSize");var a=this;$("iframe").each(function(){var b=a.winH/a.winW,c=$(this),d=parseInt(c.attr("height"))/parseInt(c.attr("width"));if(console.log(49,b,d),b>d){console.log("Full height");var e=a.winH/d/a.winW*100;c.css({width:e+"%","margin-left":0-(e-100)/2+"%","margin-top":"",height:"100%"})}else{console.log("Full width");var f=a.winW*d/a.winH*100;c.css({width:"100%","margin-left":"","margin-top":0-(a.winW*d-a.winH),height:f+"%"})}})},openVideo:function(a){console.log("Page.openVideo",a),$("#intro_portraits").fadeOut(500);var b=this;if(Info.detectMobile())console.log(210,a," pointer events auto"),$("#"+a).css("pointer-events","auto"),console.log(213,$("#"+a)),this.mobilePlayer=new Vimeo.Player($("#"+a)),this.mobilePlayer.play(),this.mobilePlayer.on("ended",function(){b.closeVideo()});else if("video_1"===a){if(void 0===this.player_1){var c=$("#video_1").attr("data-src");$("#video_1").attr("src",c),this.player_1=new Vimeo.Player($("#video_1"))}this.player_1.play(),this.player_1.on("timeupdate",function(a){a.percent>=.99&&b.closeVideo(b.player_1)}),this.currentPlayer=this.player_1}else if("video_2"===a){if(void 0===this.player_2){var c=$("#video_2").attr("data-src");$("#video_2").attr("src",c),this.player_2=new Vimeo.Player($("#video_2"))}this.player_2.play(),this.player_2.on("timeupdate",function(a){a.percent>=.99&&b.closeVideo(b.player_2)}),this.currentPlayer=this.player_2}else if("video_3"===a){if(void 0===this.player_3){var c=$("#video_3").attr("data-src");$("#video_3").attr("src",c),this.player_3=new Vimeo.Player($("#video_3"))}this.player_3.play(),this.player_3.on("timeupdate",function(a){console.log(193,"video_3",a.percent),a.percent>=.99&&b.closeVideo(b.player_3)}),this.currentPlayer=this.player_3}$("#"+a).fadeIn(500),$(".back_button").fadeIn(1e3)},closeVideo:function(a){console.log("Page.closeVideo"),$("#videos iframe").hide(),$(".back_button").fadeOut(1e3),console.log(229,this.currentPlayer),void 0!==a&&(a.pause(),a.setCurrentTime(0)),void 0!==this.mobilePlayer&&(this.mobilePlayer.pause(),this.mobilePlayer.setCurrentTime(0)),_.defer(function(){$("#intro_portraits").fadeIn(500)})}};$(document).on("ready",function(){Page.init()});